!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.SpriteSpin={})}(this,function(e){"use strict";var i=function(e){this.data=e};function o(e){var t=i.prototype;for(var n in e)if(e.hasOwnProperty(n)){if(t[n])throw new Error("API method is already defined: "+n);t[n]=e[n]}return t}var r,s,t,p=window.jQuery||window.$;function u(e){var t=e.touches,n=e;return void 0===e.touches&&void 0!==e.originalEvent&&(t=e.originalEvent.touches),void 0!==t&&0<t.length&&(n=t[0]),{x:n.clientX||0,y:n.clientY||0}}function f(e,t,n){if(!(s||(r||(r=document.createElement("canvas")),r&&r.getContext&&(s=r.getContext("2d")))))return!1;if(t*n<=1048576)return!1;r.width=r.height=1,s.fillStyle="#FF00FF",s.fillRect(0,0,1,1),s.drawImage(e,1-t,0);try{var a=s.getImageData(0,0,1,1).data;return 255===a[0]&&0===a[1]&&255===a[2]}catch(e){return!1}}function h(e){var t=Math.floor(e.width||e.frameWidth||e.target.innerWidth()),n=Math.floor(e.height||e.frameHeight||e.target.innerHeight());return{aspect:t/n,height:n,width:t}}function v(e){var t=h(e);if("function"!=typeof window.getComputedStyle)return t;var n=window.getComputedStyle(e.target[0]);return n.width&&(t.width=Math.floor(Number(n.width.replace("px",""))),t.height=Math.floor(t.width/t.aspect)),t}function w(e){var t=Math.floor(e.frameWidth||e.width||e.target.innerWidth()),n=Math.floor(e.frameHeight||e.height||e.target.innerHeight());return{aspect:t/n,height:n,width:t}}function b(e,t,n){var a="fit"===e,r="fill"===e,i={width:"100%",height:"100%",top:0,left:0,bottom:0,right:0,position:"absolute",overflow:"hidden"};if(!e||"stretch"===e)return i;var o=t.aspect>=n.aspect,s=t.width,u=t.height;return(a&&o||r&&!o)&&(s=n.width,u=n.width/t.aspect),(r&&o||a&&!o)&&(u=n.height,s=n.height*t.aspect),s=Math.floor(s),u=Math.floor(u),i.width=s,i.height=u,i.top=Math.floor((n.height-u)/2),i.left=Math.floor((n.width-s)/2),i.right=i.left,i.bottom=i.top,i}function x(e){return e.naturalWidth?{height:e.naturalHeight,width:e.naturalWidth}:((t=t||new Image).src=e.src,{height:t.height,width:t.width})}function n(e,t){return 1===e.length?[l(e[0],t)]:t.framesX&&t.framesY?function(e,t){for(var n=[],a=0;a<e.length;a++){var r=l(e[a],{frames:void 0,framesX:t.framesX,framesY:t.framesY,detectSubsampling:t.detectSubsampling});r.id=a,n.push(r)}return n}(e,t):function(e,t){for(var n=[],a=0;a<e.length;a++){var r=l(e[a],{frames:1,framesX:1,detectSubsampling:t.detectSubsampling});r.id=a,n.push(r)}return n}(e,t)}function l(e,t){var n={id:0,sprites:[]};!function(e,t,n){var a=x(e);n.isSubsampled=t.detectSubsampling&&f(e,a.width,a.height),n.width=a.width,n.height=a.height,n.sampledWidth=a.width/(n.isSubsampled?2:1),n.sampledHeight=a.height/(n.isSubsampled?2:1)}(e,t,n);for(var a=t.frames,r=Number(t.framesX)||a,i=Math.ceil(a/r),o=Math.floor(n.width/r),s=Math.floor(n.height/i),u=n.isSubsampled?2:1,l=0;l<a;l++){var c=l%r*o,d=Math.floor(l/r)*s;n.sprites.push({id:l,x:c,y:d,width:o,height:s,sampledX:c/u,sampledY:d/u,sampledWidth:o/u,sampledHeight:s/u})}return n}function y(e,t,n,a){for(var r=a*t+n,i=0,o=null,s=null;s=e[i];){if(!(r>=s.sprites.length)){o=s.sprites[r];break}r-=s.sprites.length,i++}return{sprite:o,sheet:s}}function k(){}function a(e){var t,n=e.source;t="string"==typeof n?[n]:n;for(var a=[],r=e.preloadCount||t.length,i=e.initiated||k,o=e.progress||k,s=e.complete||k,u=0,l=!1,c=!1,d=function(){u+=1,o({index:function(e,t){for(var n=0;n<t.length;n++)if(t[n]===e)return n}(this,a),loaded:u,total:t.length,percent:Math.round(u/t.length*100)}),(c=c||this===a[0])&&!l&&r<=u&&(l=!0,s(a))},f=0,m=t;f<m.length;f++){var g=m[f],h=new Image;a.push(h),h.onload=h.onabort=h.onerror=d,h.src=g}i(a)}function m(e,t,n){for(var a=String(e);a.length<t;)a=String(n)+a;return a}function c(e,t){var n=t.digits||2,a=t.lanePlacer||"{lane}",r=t.framePlacer||"{frame}",i=0,o=0;t.frame&&(i=t.frame[0],o=t.frame[1]);var s=0,u=0;t.lane&&(s=t.lane[0],u=t.lane[1]);for(var l=[],c=s;c<=u;c+=1)for(var d=i;d<=o;d+=1)l.push(e.replace(a,m(c,n,"0")).replace(r,m(d,n,"0")));return l}var d="spritespin",g=["mousedown","mousemove","mouseup","mouseenter","mouseover","mouseleave","mousewheel","wheel","click","dblclick","touchstart","touchmove","touchend","touchcancel","selectstart","gesturestart","gesturechange","gestureend"],X=["onInit","onProgress","onLoad","onFrameChanged","onFrame","onDraw","onComplete","onDestroy"],M=["dragstart"],S={source:void 0,width:void 0,height:void 0,frames:void 0,framesX:void 0,lanes:1,sizeMode:void 0,renderer:"canvas",lane:0,frame:0,frameTime:40,animate:!1,retainAnimate:!1,reverse:!1,loop:!1,stopFrame:0,wrap:!0,wrapLane:!1,sense:1,senseLane:void 0,orientation:"horizontal",detectSubsampling:!0,preloadCount:void 0,responsive:void 0,plugins:["360","drag"]};function F(){}function Y(e){return console&&console[e]?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return console.log.apply(console,e)}:F}var T=Y("log"),z=Y("warn"),C=Y("error");function R(e){return Array.isArray(e)?e:[e]}function P(e,t,n){return n<e?n:e<t?t:e}function E(e,t,n,a){for(;n<e;)e-=a;for(;e<t;)e+=a;return e}function A(e){return e.preventDefault(),!1}function D(t,e,n){n&&t.bind(e+"."+d,function(e){n.apply(t,[e,t.spritespin("data")])})}function I(e){e.unbind("."+d)}function W(e){return(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)}var H=Object.freeze({$:p,getCursorPosition:u,detectSubsampling:f,getOuterSize:h,getComputedSize:v,getInnerSize:w,getInnerLayout:b,measure:n,findSpecs:y,naturalSize:x,preload:a,sourceArray:c,noop:F,log:T,warn:z,error:C,toArray:R,clamp:P,wrap:E,prevent:A,bind:D,unbind:I,isFunction:function(e){return"function"==typeof e},pixelRatio:W});function L(e){e.target.attr("unselectable","on").css({width:"",height:"","-ms-user-select":"none","-moz-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","user-select":"none"});var t=e.responsive?v(e):h(e),n=b(e.sizeMode,w(e),t);e.target.css({width:t.width,height:t.height,position:"relative",overflow:"hidden"}),e.stage.css(n).hide(),e.canvas&&(e.canvas.css(n).hide(),e.canvasRatio=e.canvasRatio||W(e.context),"number"==typeof n.width&&"number"==typeof n.height?(e.canvas[0].width=n.width*e.canvasRatio||t.width,e.canvas[0].height=n.height*e.canvasRatio||t.height):(e.canvas[0].width=t.width*e.canvasRatio,e.canvas[0].height=t.height*e.canvasRatio),e.context.scale(e.canvasRatio,e.canvasRatio))}function O(e,t){return e.state=e.state||{},e.state[t]=e.state[t]||{},e.state[t]}function q(e,t){var n=O(e,"plugin");return n[t]=n[t]||{},n[t]}function B(e,t){return!!O(e,"flags")[t]}function N(e,t,n){O(e,"flags")[t]=!!n}function j(e){return O(e,"playback")}function U(e){j(e).handler&&(_(e),function(e){e.frame+=e.reverse?-1:1,e.frame=E(e.frame,0,e.frames-1,e.frames),e.loop||e.frame!==e.stopFrame||G(e)}(e),Q(e))}function _(e){var t=j(e);t.lastFrame=e.frame,t.lastLane=e.lane}function Q(e){var t=j(e);t.lastFrame===e.frame&&t.lastLane===e.lane||e.target.trigger("onFrameChanged."+d,e),e.target.trigger("onFrame."+d,e),e.target.trigger("onDraw."+d,e)}function Z(e,t,n){_(e),null!=t&&function(e,t){e.frame=Number(t),e.frame=e.wrap?E(e.frame,0,e.frames-1,e.frames):P(e.frame,0,e.frames-1)}(e,t),null!=n&&function(e,t){e.lane=e.wrapLane?E(t,0,e.lanes-1,e.lanes):P(t,0,e.lanes-1)}(e,n),Q(e)}function G(e){e.animate=!1;var t=j(e);null!=t.handler&&(window.clearInterval(t.handler),t.handler=null)}function J(e){var t=j(e);!t.handler||e.animate&&t.frameTime===e.frameTime||G(e),e.animate&&!t.handler&&(t.frameTime=e.frameTime,t.handler=window.setInterval(function(){return U(e)},t.frameTime))}function K(e){e.animate=!0,J(e)}var V={};function ee(e,t){if(!V[e])return t=t||{},V[e]=t;C('Plugin name "'+e+'" is already taken')}function te(e){return V[e]}function ne(e){!function(e){e.mods&&(z('"mods" option is deprecated, use "plugins" instead'),e.plugins=e.mods,delete e.mods);e.behavior&&(z('"behavior" option is deprecated, use "plugins" instead'),e.plugins.push(e.behavior),delete e.behavior);e.module&&(z('"module" option is deprecated, use "plugins" instead'),e.plugins.push(e.module),delete e.module)}(e);for(var t=0;t<e.plugins.length;t+=1){var n=e.plugins[t];if("string"==typeof n){var a=te(n);a?e.plugins[t]=a:C("No plugin found with name "+n)}}}var ae=p,re=0,ie={};function oe(e){for(var t in ie)ie.hasOwnProperty(t)&&e(ie[t])}var se=function(){function e(){oe(function(e){e.responsive&&le(e)})}se=function(){};for(var t=function(t){ae(window.document).bind(t+"."+d,function(e){!function(r,i){oe(function(e){for(var t=0,n=e.plugins;t<n.length;t++){var a=n[t];"function"==typeof a[r]&&a[r].apply(e.target,[i,e])}})}("document"+t,e)})},n=0,a=g;n<a.length;n++){t(a[n])}var r=null;ae(window).on("resize",function(){window.clearTimeout(r),r=window.setTimeout(e,100)})};function ue(e){var t=e.target;I(t);for(var n=0,a=M;n<a.length;n++){D(t,m=a[n],A)}for(var r=0,i=e.plugins;r<i.length;r++){for(var o=i[r],s=0,u=g;s<u.length;s++){D(t,m=u[s],o[m])}for(var l=0,c=X;l<c.length;l++){D(t,m=c[l],o[m])}}D(t,"onLoad",function(e,t){J(t)});for(var d=0,f=X;d<f.length;d++){var m;D(t,m=f[d],e[m])}}function le(t){ne(t),ue(t),L(t),t.source=R(t.source),t.loading=!0,t.target.addClass("loading").trigger("onInit."+d,t),a({source:t.source,preloadCount:t.preloadCount,progress:function(e){t.progress=e,t.target.trigger("onProgress."+d,t)},complete:function(e){t.images=e,t.loading=!1,t.frames=t.frames||e.length,function(e){e.images||(e.metrics=[]),e.metrics=n(e.images,e);var t=y(e.metrics,e.frames,0,0);t.sprite&&(e.frameWidth=t.sprite.width,e.frameHeight=t.sprite.height)}(t),L(t),t.stage.show(),t.target.removeClass("loading").trigger("onLoad."+d,t).trigger("onFrame."+d,t).trigger("onDraw."+d,t).trigger("onComplete."+d,t)}})}function ce(e){var t=this,n=e.target,a=ae.extend(!0,{},S,e);if(a.source=a.source||[],a.plugins=a.plugins||[],n.find("img").each(function(){Array.isArray(a.source)||(a.source=[]),a.source.push(ae(t).attr("src"))}),n.empty().addClass("spritespin-instance").append("<div class='spritespin-stage'></div>"),"canvas"===a.renderer){var r=document.createElement("canvas");r.getContext&&r.getContext("2d")?(a.canvas=ae(r).addClass("spritespin-canvas"),a.context=r.getContext("2d"),n.append(a.canvas),n.addClass("with-canvas")):a.renderer="image"}return a.target=n,a.stage=n.find(".spritespin-stage"),n.data(d,a),function(e){re+=1,e.id=String(re),ie[e.id]=e}(a),a}function de(e){se();var t=e.target.data(d);return t?ae.extend(t,e):t=ce(e),le(t),t}function fe(e){!function(e){delete ie[e.id]}(e),G(e),e.target.trigger("onDestroy",e).html(null).attr("style",null).attr("unselectable",null).removeClass(["spritespin-instance","with-canvas"]),I(e.target),e.target.removeData(d)}function me(e){return O(e,"input")}function ge(e,t){var n=u(e),a=me(t);a.oldX=a.currentX,a.oldY=a.currentY,a.currentX=n.x,a.currentY=n.y,void 0!==a.oldX&&void 0!==a.oldY||(a.oldX=a.currentX,a.oldY=a.currentY),void 0!==a.startX&&void 0!==a.startY||(a.startX=a.currentX,a.startY=a.currentY,a.clickframe=t.frame,a.clicklane=t.lane),a.dX=a.currentX-a.startX,a.dY=a.currentY-a.startY,a.ddX=a.currentX-a.oldX,a.ddY=a.currentY-a.oldY,a.ndX=a.dX/t.target.innerWidth(),a.ndY=a.dY/t.target.innerHeight(),a.nddX=a.ddX/t.target.innerWidth(),a.nddY=a.ddY/t.target.innerHeight()}function he(e){var t=me(e);t.startX=t.startY=void 0,t.currentX=t.currentY=void 0,t.oldX=t.oldY=void 0,t.dX=t.dY=0,t.ddX=t.ddY=0,t.ndX=t.ndY=0,t.nddX=t.nddY=0}function pe(e,t){for(var n=0,a=t;n<a.length;n++){var r=a[n];if(e[r]||r in e)return r}return t[0]}p.fn[d]=function(e,t){var n,a=p(this);if("data"===e)return a.data(d);if("api"===e){var r=a.data(d);return r.api=r.api||new i(r),r.api}if("destroy"===e)return a.each(function(){var e=a.data(d);e&&fe(e)});if(2===arguments.length&&"string"==typeof e&&((n={})[e]=t,e=n),"object"==typeof e)return de(p.extend(!0,{target:a},e)).target;throw new Error("Invalid call to spritespin")},o({isPlaying:function(){return null!=j(this.data).handler},isLooping:function(){return this.data.loop},toggleAnimation:function(){this.isPlaying()?this.stopAnimation():this.startAnimation()},stopAnimation:function(){this.data.animate=!1,G(this.data)},startAnimation:function(){this.data.animate=!0,J(this.data)},loop:function(e){return this.data.loop=e,J(this.data),this},currentFrame:function(){return this.data.frame},updateFrame:function(e){return Z(this.data,e),this},skipFrames:function(e){var t=this.data;return Z(t,t.frame+(t.reverse?-e:+e)),this},nextFrame:function(){return this.skipFrames(1)},prevFrame:function(){return this.skipFrames(-1)},playTo:function(e,t){var n=this.data;if((t=t||{}).force||n.frame!==e){if(t.nearest){var a=e-n.frame,r=e>n.frame?a-n.frames:a+n.frames,i=Math.abs(a)<Math.abs(r)?a:r;n.reverse=i<0}return n.animate=!0,n.loop=!1,n.stopFrame=e,J(n),this}}});var ve={requestFullscreen:pe(document.documentElement,["requestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"]),exitFullscreen:pe(document,["exitFullscreen","webkitExitFullscreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen"]),fullscreenElement:pe(document,["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"]),fullscreenEnabled:pe(document,["fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"]),fullscreenchange:pe(document,["onfullscreenchange","onwebkitfullscreenchange","onmozfullscreenchange","onMSFullscreenChange"]).replace(/^on/,""),fullscreenerror:pe(document,["onfullscreenerror","onwebkitfullscreenerror","onmozfullscreenerror","onMSFullscreenError"]).replace(/^on/,"")},we=ve.fullscreenchange+"."+d+"-fullscreen";function be(){p(document).unbind(we)}var xe="orientationchange."+d+"-fullscreen";function ye(){p(window).unbind(xe)}function ke(){return document[ve.fullscreenElement]}function Xe(){return!!ke()}function Me(e,t){t=t||{};var n=e.width,a=e.height,r=e.source,i=e.sizeMode,o=e.responsive,s=function(){e.width=window.screen.width,e.height=window.screen.height,e.source=t.source||r,e.sizeMode=t.sizeMode||"fit",e.responsive=!1,le(e)};!function(e){be(),p(document).bind(we,e)}(function(){Xe()?(s(),function(e){ye(),p(window).bind(xe,e)}(s)):(be(),ye(),e.width=n,e.height=a,e.source=r,e.sizeMode=i,e.responsive=o,le(e))}),function(e){(e=e||document.documentElement)[ve.requestFullscreen]()}(e.target[0])}o({fullscreenEnabled:function(){return document[ve.fullscreenEnabled]},fullscreenElement:ke,exitFullscreen:function(){return document[ve.exitFullscreen]()},toggleFullscreen:function(e){!function(e,t){Xe()?this.apiRequestFullscreen(t):this.exitFullscreen()}(this.data,e)},requestFullscreen:function(e){Me(this.data,e)}}),function(){function e(e,t){if(!t.loading&&t.stage.is(":visible")){ge(e,t);var n,a,r=me(t),i=t.target,o=i.offset();a="horizontal"===t.orientation?(n=i.innerWidth()/2,r.currentX-o.left):(n=i.innerHeight()/2,r.currentY-o.top),Z(t,t.frame+(n<a?1:-1))}}ee("click",{name:"click",mouseup:e,touchend:e})}(),function(){var t="drag";function l(e){return q(e,t)}function n(e,t){var n=l(t);if(!t.loading&&!B(t,"dragging")&&t.stage.is(":visible")){var a=(new Date).getTime();n.startAt&&200<a-n.startAt&&e.preventDefault(),n.startAt=a,n.wasPlaying=!!j(t).handler,n.frame=t.frame||0,n.lane=t.lane||0,N(t,"dragging",!0),ge(e,t)}}function e(e,t){B(t,"dragging")&&(N(t,"dragging",!1),he(t),t.retainAnimate&&l(t).wasPlaying&&K(t))}function a(e,t){var n=l(t),a=me(t);if(B(t,"dragging")){ge(e,t);var r=function(e){return"number"==typeof e.orientation?e.orientation*Math.PI/180:"horizontal"===e.orientation?0:Math.PI/2}(t),i=Math.sin(r),o=Math.cos(r),s=(a.nddX*o-a.nddY*i)*t.sense||0,u=(a.nddX*i+a.nddY*o)*(t.senseLane||t.sense)||0;n.frame+=t.frames*s,n.lane+=t.lanes*u;t.frame,t.lane;Z(t,Math.floor(n.frame),Math.floor(n.lane)),G(t)}}ee("drag",{name:"drag",mousedown:n,mousemove:a,mouseup:e,documentmousemove:a,documentmouseup:e,touchstart:n,touchmove:a,touchend:e,touchcancel:e}),ee("move",{name:"move",mousemove:function(e,t){n(e,t),a(e,t)},mouseleave:e,touchstart:n,touchmove:a,touchend:e,touchcancel:e})}(),function(){var t="hold";function n(e){return q(e,t)}function e(e,t){B(t,"loading")||B(t,"dragging")||!t.stage.is(":visible")||(function(e){var t=n(e);t.frameTime=e.frameTime,t.animate=e.animate,t.reverse=e.reverse}(t),ge(e,t),N(t,"dragging",!0),t.animate=!0,J(t))}function a(e,t){N(t,"dragging",!1),he(t),G(t),function(e){var t=n(e);e.frameTime=t.frameTime,e.animate=t.animate,e.reverse=t.reverse}(t),J(t)}function r(e,t){if(B(t,"dragging")){ge(e,t);var n,a,r=me(t),i=t.target,o=i.offset();a="horizontal"===t.orientation?(n=i.innerWidth()/2,(r.currentX-o.left-n)/n):(n=t.height/2,(r.currentY-o.top-n)/n),t.reverse=a<0,a=a<0?-a:a,t.frameTime=80*(1-a)+20,("horizontal"===t.orientation&&r.dX<r.dY||"vertical"===t.orientation&&r.dX<r.dY)&&e.preventDefault()}}ee(t,{name:t,mousedown:e,mousemove:r,mouseup:a,mouseleave:a,touchstart:e,touchmove:r,touchend:a,touchcancel:a,onFrame:function(e,t){t.animate=!0,J(t)}})}(),function(){var t="swipe";function c(e){return q(e,t)}function a(e,t,n){return e[t]||n}function e(e,t){t.loading||B(t,"dragging")||(ge(e,t),N(t,"dragging",!0))}function n(e,t){B(t,"dragging")&&(ge(e,t),Z(t,t.frame,t.lane))}function r(e,t){if(B(t,"dragging")){N(t,"dragging",!1);var n,a,r=c(t),i=me(t),o=t.frame,s=t.lane,u=r.snap,l=r.fling;a="horizontal"===t.orientation?(n=i.ndX,i.ddX):(n=i.ndY,i.ddY),u<=n||l<=a?o=t.frame-1:(n<=-u||a<=-l)&&(o=t.frame+1),he(t),Z(t,o,s),G(t)}}ee(t,{name:t,onLoad:function(e,t){var n=c(t);n.fling=a(t,"swipeFling",10),n.snap=a(t,"swipeSnap",.5)},mousedown:e,mousemove:n,mouseup:r,mouseleave:r,touchstart:e,touchmove:n,touchend:r,touchcancel:r})}(),ee("wheel",{name:"wheel",wheel:function(e,t){if(!t.loading&&t.stage.is(":visible")){e.preventDefault();var n=e.originalEvent,a=0===n.deltaX?0:0<n.deltaX?1:-1,r=0===n.deltaY?0:0<n.deltaY?1:-1;Z(t,t.frame+r,t.lane+a)}}}),function(){function a(e){return q(e,t)}var t="progress";ee(t,{name:t,onInit:function(e,t){var n=a(t);n.stage||(n.stage=p("\n<div class='spritespin-progress'>\n  <div class='spritespin-progress-label'></div>\n  <div class='spritespin-progress-bar'></div>\n</div>\n"),n.stage.appendTo(t.target)),n.stage.find(".spritespin-progress-label").text("0%").css({"text-align":"center"}),n.stage.find(".spritespin-progress-bar").css({width:"0%"}),n.stage.hide().fadeIn()},onProgress:function(e,t){var n=a(t);n.stage.find(".spritespin-progress-label").text(t.progress.percent+"%").css({"text-align":"center"}),n.stage.find(".spritespin-progress-bar").css({width:t.progress.percent+"%"})},onLoad:function(e,t){p(a(t).stage).fadeOut()},onDestroy:function(e,t){p(a(t).stage).remove()}})}(),ee("360",{name:"360",onLoad:function(e,t){t.stage.find(".spritespin-frames").detach(),"image"===t.renderer&&$(t.images).addClass("spritespin-frames").appendTo(t.stage)},onDraw:function(e,t){var n=y(t.metrics,t.frames,t.frame,t.lane),a=n.sheet,r=n.sprite;if(a&&r){var i=t.source[a.id],o=t.images[a.id];if("canvas"===t.renderer){t.canvas.show();var s=t.canvas[0].width/t.canvasRatio,u=t.canvas[0].height/t.canvasRatio;return t.context.clearRect(0,0,s,u),void t.context.drawImage(o,r.sampledX,r.sampledY,r.sampledWidth,r.sampledHeight,0,0,s,u)}var l=t.stage.innerWidth()/r.sampledWidth,c=t.stage.innerHeight()/r.sampledHeight,d=Math.floor(-r.sampledY*c),f=Math.floor(-r.sampledX*l),m=Math.floor(a.sampledWidth*l),g=Math.floor(a.sampledHeight*c);"background"!==t.renderer?($(t.images).hide(),$(o).show().css({position:"absolute",top:d,left:f,"max-width":"initial",width:m,height:g})):t.stage.css({"background-image":"url('"+i+"')","background-position":f+"px "+d+"px","background-repeat":"no-repeat","-webkit-background-size":m+"px "+g+"px","-moz-background-size":m+"px "+g+"px","-o-background-size":m+"px "+g+"px","background-size":m+"px "+g+"px"})}}}),function(){var t="blur";function o(e){return q(e,t)}function s(e,t,n){return e[t]||n}var u=[];function l(e){var t=o(e);t.timeout=window.setTimeout(function(){!function(e){var t=o(e);if(function(e){var t=o(e);window.clearTimeout(t.timeout),t.timeout=null}(e),!t.context)return;var n=0;(function(e,t){t.canvas.show();t.canvas[0].width,e.canvasRatio,t.canvas[0].height,e.canvasRatio})(e,t),t.context.clearRect(0,0,e.width,e.height);for(var a=0,r=t.steps;a<r.length;a++){var i=r[a];i.live=Math.max(i.live-i.step,0),i.alpha=Math.max(i.live-.25,0),c(e,t,i),n+=i.alpha+i.d}t.cssBlur&&function(e,t){var n="blur("+Math.min(Math.max(t/2-4,0),2.5)+"px)";e.css({"-webkit-filter":n,filter:n})}(t.canvas,n);(function(e){for(var t=u.length=0;t<e.length;t+=1)e[t].alpha<=0&&u.push(t);for(var n=0,a=u;n<a.length;n++){var r=a[n];e.splice(r,1)}})(t.steps),t.steps.length&&l(e)}(e)},t.frameTime)}function c(e,t,n){if(!(n.alpha<=0)){var a=y(e.metrics,e.frames,n.frame,n.lane),r=a.sheet,i=a.sprite;if(r&&i){e.source[r.id];var o=e.images[r.id];if(!1!==o.complete){t.canvas.show();var s=t.canvas[0].width/e.canvasRatio,u=t.canvas[0].height/e.canvasRatio;t.context.globalAlpha=n.alpha,t.context.drawImage(o,i.sampledX,i.sampledY,i.sampledWidth,i.sampledHeight,0,0,s,u)}}}}ee(t,{name:t,onLoad:function(e,t){var n=o(t);n.canvas=n.canvas||p("<canvas class='blur-layer'></canvas>"),n.context=n.context||n.canvas[0].getContext("2d"),n.steps=n.steps||[],n.fadeTime=Math.max(s(t,"blurFadeTime",200),1),n.frameTime=Math.max(s(t,"blurFrameTime",t.frameTime),16),n.trackTime=null,n.cssBlur=!!s(t,"blurCss",!1);var a=w(t),r=t.responsive?v(t):h(t),i=b(t.sizeMode,a,r);n.canvas[0].width=t.width*t.canvasRatio,n.canvas[0].height=t.height*t.canvasRatio,n.canvas.css(i).show(),n.context.scale(t.canvasRatio,t.canvasRatio),t.target.append(n.canvas)},onFrameChanged:function(e,t){var n=o(t);!function(e){var t=o(e),n=j(e),a=Math.abs(e.frame-n.lastFrame);a=a>=e.frames/2?e.frames-a:a,t.steps.unshift({frame:e.frame,lane:e.lane,live:1,step:t.frameTime/t.fadeTime,d:a,alpha:0})}(t),null==n.timeout&&l(t)}})}(),function(){var a=Math.max,r=Math.min,t="ease";function f(e){return q(e,t)}function i(e,t,n){return e[t]||n}function e(e,t){B(t,"dragging")&&(m(t),function(e){var t=f(e);t.samples.push({time:(new Date).getTime(),frame:e.frame,lane:e.lane});for(;t.samples.length>t.maxSamples;)t.samples.shift()}(t))}function n(e,t){for(var n,a=f(t),r=a.samples,i=0,o=0,s=0,u=0,l=r;u<l.length;u++){var c=l[u];if(n){var d=c.time-n.time;if(d>a.abortTime)return i=o=s=0,m(t);o+=c.frame-n.frame,i+=c.lane-n.lane,s+=d,n=c}else n=c}r.length=0,s&&(a.lane=t.lane,a.lanes=0,a.laneStep=i/s*a.updateTime,a.frame=t.frame,a.frames=0,a.frameStep=o/s*a.updateTime,g(t))}function m(e){var t=f(e);null!=t.handler&&(window.clearTimeout(t.handler),t.handler=null)}function g(e){var t=f(e);t.handler=window.setTimeout(function(){!function(e){var t=f(e);t.lanes+=t.laneStep,t.frames+=t.frameStep,t.laneStep*=t.damping,t.frameStep*=t.damping;var n=Math.floor(t.frame+t.frames),a=Math.floor(t.lane+t.lanes);Z(e,n,a),B(e,"dragging")?m(e):.005<Math.abs(t.frameStep)||.005<Math.abs(t.laneStep)?g(e):m(e)}(e)},t.updateTime)}ee(t,{name:t,onLoad:function(e,t){var n=f(t);n.maxSamples=a(i(t,"easeMaxSamples",5),0),n.damping=a(r(i(t,"easeDamping",.9),.999),0),n.abortTime=a(i(t,"easeAbortTime",250),16),n.updateTime=a(i(t,"easeUpdateTime",t.frameTime),16),n.samples=[],n.steps=[]},mousemove:e,mouseup:n,mouseleave:n,touchmove:e,touchend:n,touchcancel:n})}(),function(){var t="gallery";function m(e){return q(e,t)}function g(e,t,n){return e[t]||n}ee(t,{name:t,onLoad:function(e,t){var n=m(t);n.images=[],n.offsets=[],n.frame=t.frame,n.speed=g(t,"gallerySpeed",500),n.opacity=g(t,"galleryOpacity",.25),n.stage=g(t,"galleryStage",p("<div></div>")),n.stage.empty().addClass("gallery-stage").prependTo(t.stage);for(var a=0,r=0,i=t.images;r<i.length;r++){var o=i[r],s=x(o),u=t.height/s.height,l=p(o);n.stage.append(l),n.images.push(l),n.offsets.push(-a+(t.width-o.width*u)/2),a+=t.width,l.css({"max-width":"initial",opacity:n.opacity,width:t.width,height:t.height})}var c=w(t),d=t.responsive?v(t):h(t),f=b(t.sizeMode,c,d);n.stage.css(f).css({width:a,left:n.offsets[n.frame]}),n.images[n.frame].animate({opacity:1},{duration:n.speed})},onDraw:function(e,t){var n=m(t),a=me(t),r=B(t,"dragging");n.frame===t.frame||r?(r||n.dX!==a.dX)&&(n.dX=a.dX,n.ddX=a.ddX,n.stage.stop(!0,!0).css({left:n.offsets[n.frame]+n.dX})):(n.stage.stop(!0,!1).animate({left:n.offsets[t.frame]},{duration:n.speed}),n.images[n.frame].animate({opacity:n.opacity},{duration:n.speed}),n.frame=t.frame,n.images[n.frame].animate({opacity:1},{duration:n.speed}),n.stage.animate({left:n.offsets[n.frame]}))}})}(),function(){var t="panorama";function u(e){return q(e,t)}ee(t,{name:t,onLoad:function(e,t){var n=u(t),a=t.metrics[0];if(a){"horizontal"===t.orientation?(n.scale=t.target.innerHeight()/a.sampledHeight,t.frames=a.sampledWidth):(n.scale=t.target.innerWidth()/a.sampledWidth,t.frames=a.sampledHeight);var r=Math.floor(a.sampledWidth*n.scale),i=Math.floor(a.sampledHeight*n.scale);t.stage.css({"background-image":"url("+t.source[a.id]+")","background-repeat":"repeat-both","-webkit-background-size":r+"px "+i+"px","-moz-background-size":r+"px "+i+"px","-o-background-size":r+"px "+i+"px","background-size":r+"px "+i+"px"})}},onDraw:function(e,t){var n=u(t),a="horizontal"===t.orientation?1:0,r=a?0:1,i=t.frame%t.frames,o=Math.round(a*i*n.scale),s=Math.round(r*i*n.scale);t.stage.css({"background-position":o+"px "+s+"px"})}})}(),function(){var t="zoom";function h(e){return q(e,t)}function a(e,t,n){return e[t]||n}function r(e,t){var n=h(t);if(n.stage.is(":visible")){e.preventDefault(),N(t,"dragging",!1);var a=u(e),r=a.x/t.width,i=a.y/t.height;null==n.oldX&&(n.oldX=r,n.oldY=i),null==n.currentX&&(n.currentX=r,n.currentY=i);var o=r-n.oldX,s=i-n.oldY;n.oldX=r,n.oldY=i,e.type.match(/touch/)&&(o=-o,s=-s),n.currentX=P(n.currentX+o,0,1),n.currentY=P(n.currentY+s,0,1),Z(t,t.frame,t.lane)}}function e(e,t){e.preventDefault();var n=h(t),a=(new Date).getTime();n.clickTime?a-n.clickTime>n.doubleClickTime?n.clickTime=a:(n.clickTime=void 0,i(t)&&r(e,t)):n.clickTime=a}function n(e,t){h(t).stage.is(":visible")&&r(e,t)}function i(e){var t=h(e);if(!t.stage)throw new Error("zoom module is not initialized or is not available.");return t.stage.is(":visible")?(t.stage.fadeOut(),e.stage.fadeIn(),!1):(t.stage.fadeIn(),e.stage.fadeOut(),!0)}ee(t,{name:t,mousedown:e,touchstart:e,mousemove:n,touchmove:n,onInit:function(e,t){var n=h(t);n.source=a(t,"zoomSource",t.source),n.doubleClickTime=a(t,"zoomDoubleClickTime",500),n.stage=n.stage||p("<div class='zoom-stage'></div>"),n.stage.css({width:"100%",height:"100%",top:0,left:0,bottom:0,right:0,position:"absolute"}).appendTo(t.target).hide()},onDestroy:function(e,t){var n=h(t);n.stage&&(n.stage.remove(),delete n.stage)},onDraw:function(e,t){var n=h(t),a=t.lane*t.frames+t.frame,r=n.source[a],i=y(t.metrics,t.frames,t.frame,t.lane),o=n.currentX,s=n.currentY;if(null==o&&(o=n.currentX=.5,s=n.currentY=.5),r)o=Math.floor(100*o),s=Math.floor(100*s),n.stage.css({"background-repeat":"no-repeat","background-image":"url('"+r+"')","background-position":o+"% "+s+"%"});else if(i.sheet&&i.sprite){var u=i.sprite,l=i.sheet,c=t.source[l.id],d=-Math.floor(u.sampledX+o*(u.sampledWidth-t.width)),f=-Math.floor(u.sampledY+s*(u.sampledHeight-t.height)),m=l.sampledWidth,g=l.sampledHeight;n.stage.css({"background-image":"url('"+c+"')","background-position":d+"px "+f+"px","background-repeat":"no-repeat","-webkit-background-size":m+"px "+g+"px","-moz-background-size":m+"px "+g+"px","-o-background-size":m+"px "+g+"px","background-size":m+"px "+g+"px"})}}}),o({toggleZoom:function(){i(this.data)}})}();var Se=H;e.Utils=Se,e.sourceArray=c,e.Api=i,e.extendApi=o,e.instances=ie,e.applyEvents=ue,e.boot=le,e.create=ce,e.createOrUpdate=de,e.destroy=fe,e.namespace=d,e.eventNames=g,e.callbackNames=X,e.eventsToPrevent=M,e.defaults=S,e.getInputState=me,e.updateInput=ge,e.resetInput=he,e.applyLayout=L,e.getPlaybackState=j,e.updateFrame=Z,e.stopAnimation=G,e.applyAnimation=J,e.startAnimation=K,e.registerPlugin=ee,e.registerModule=function(e,t){z('"registerModule" is deprecated, use "registerPlugin" instead'),ee(e,t)},e.getPlugin=te,e.applyPlugins=ne,e.getState=O,e.getPluginState=q,e.is=B,e.flag=N,Object.defineProperty(e,"__esModule",{value:!0})});
!function(t,s,n,e){"use strict";function o(s,n){this.container=t(s),this.settings=t.extend({},i,n,this.container.data()),this._sorting=!1,this.elementClass="sort-scroll-element",this.sortingClass="sort-scroll-sorting",this.buttonUpClass="sort-scroll-button-up",this.buttonDownClass="sort-scroll-button-down",this.init()}var i={animationDuration:1e3,cssEasing:"ease-in-out",keepStill:!0,fixedElementsSelector:""};t.extend(o.prototype,{init:function(){var s=this;s.container.on("click","."+s.buttonUpClass+", ."+s.buttonDownClass,function(n){n.preventDefault();var e,o=t(this),i=s.container.find("."+s.elementClass),r=i.index(o.closest("."+s.elementClass));e=o.hasClass(s.buttonUpClass)?-1:1,s.sortElement(r,e,s.settings.keepStill)})},sortElement:function(e,o,i){o=-1===o?o:1,i=i?this.settings.keepStill:!1;var r=this,a=r.container.find("."+r.elementClass),l=a.length-1,c=e+o;if(0>c||c>l)return!1;if(r._sorting)return r.container.one("sortScroll.sortEnd",function(t,s,n,e){r.sortElement(e,o,i)}),!1;a.each(function(){t(this).css("top",0)});var d=a.eq(e),u=d.outerHeight(!0),f=d.offset().top,h=a.eq(c),p=h.outerHeight(!0),g=h.offset().top,m=h.offset().top,v=g+u,C=0,x=parseInt(h.css("margin-top"),10);o>0&&(m=f+p,v=f,C=parseInt(d.css("margin-top"),10),x=0);var E,S=m-f-C,b=v-g-x,y=r.settings.animationDuration,w=r.settings.cssEasing,D=t("body"),T=d.css("z-index"),k=t.Deferred(),H=t.Deferred(),_=t.Deferred(),M="transitionend webkitTransitionEnd msTransitionEnd oTransitionEnd",U="style";if(E="auto"===T?2:T+1,r.container.trigger("sortScroll.sortStart",[d,e,c]),r._sorting=!0,d.data(U,d.attr(U)),h.data(U,h.attr(U)),d.add(h).css({position:"relative",transition:y+"ms "+w}),d.addClass(r.sortingClass).css({"z-index":E,top:S+"px"}),h.css({top:b+"px"}),i){var q=t(s).scrollTop(),z=q+S,I=Math.max(0,n.documentElement.scrollHeight-n.documentElement.clientHeight),j=t(r.settings.fixedElementsSelector).filter(function(){return"fixed"===t(this).css("position")});z=Math.min(z,I),z=Math.max(z,0),D.data(U,D.attr(U)||"").css({transition:y+"ms "+w,"margin-top":q-z+"px"}),j.each(function(){t(this).data(U,t(this).attr(U)||"")}).css({transition:y+"ms "+w,"margin-top":-(q-z)+"px"})}d.one(M,function(){k.resolve()}),h.one(M,function(){H.resolve()}),D.one(M,function(){_.resolve()}),t.when(k,H,_).done(function(){d.attr(U,d.data(U)),h.attr(U,h.data(U)),D.attr(U,D.data(U)),i&&(t("html, body").scrollTop(z+(t(s).scrollTop()-q)),j.each(function(){t(this).attr(U,t(this).data(U))})),d.removeClass(r.sortingClass),o>0?h.after(d):h.before(d),r._sorting=!1,r.container.trigger("sortScroll.sortEnd",[d,e,c])})}}),t.fn.sortScroll=function(s){var n=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=t(this),i=e.data("sortScroll");i?"string"==typeof s&&i[s].apply(i,n):e.data("sortScroll",new o(this,s))})},t(".sort-scroll-container").each(function(){t(this).sortScroll()})}(jQuery,window,document);
